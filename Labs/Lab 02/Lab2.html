<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta content="en-us" http-equiv="Content-Language">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link href="Lab2_files/css.css" rel="stylesheet">
<title>Untitled 1</title>
<style type="text/css">
.heading1 {
	font-family: 'Oswald', sans-serif;
	font-size: xx-large;
	text-align: Center;
	color: grey;
}
.heading2 {
	font-family: 'Roboto', sans-serif;
	font-size: large;
}
.body1 {
	font-family: 'Roboto', sans-serif;
	font-size: large;
}
.body2 {
	font-family: 'Roboto', sans-serif;
	font-size: large;
}
.coding1 {
	font-family: 'Cutive Mono', monospace;
	font-size: medium;
}
</style>
</head>

<body>

<p class="heading1"><strong>Lab 2 - Using the Debugger</strong></p>
<hr width="100%" size="2px" color="red">

<p class="heading2">In this lab, we cover how to use the debugger with a
sample program. You will need to fix numerous errors in the program using GDB
and Valgrind.</p>

<p class="heading1">Lab Materials</p>
<hr width="100%" size="2px" color="red">

<ul class="body1">
	<li><a href="http://www.ittc.ku.edu/%7Eheechul/courses/eecs678/S17/labs/lab2/GDBLab.pdf">Slides</a></li>
	<li><a href="http://www.ittc.ku.edu/%7Eheechul/courses/eecs678/S17/labs/lab2/eecs678-debugger-lab.tar.gz">Lab materials [Updated]</a></li>
</ul>

<p class="heading1">Assignment</p>
<hr width="100%" size="2px" color="red">

<span class="body1"> 
The sample program currently produces a segmentation fault:
</span>

<pre class="coding1">$ ./bugs
The current bug population of Earth is about: 1480000000000000000
The current bug population of Mars is about: 140727437236104
The current bug population of Venus is about: 0
The total bug population of the solar system is: 1480000000000000000
The most useless bug is a butterfly Segmentation fault (core dumped)</pre> 

<span class="body1"> 
Your task for this lab is to find an fix all of the problems with the aid of  
debugger. When you are finished, the test output should print:
</span>

<pre class="coding1">$ make test
gcc -g bugs.c -o bugs
valgrind --leak-check=full ./bugs &gt; bugs_output.txt 2&gt; valgrind_output.txt

=======================================
VALGRIND DIFF
---------------------------------------

=======================================
PROGRAM DIFF
---------------------------------------

$ cat bugs_output.txt
The current bug population of Earth is about: 1480000000000000000
The current bug population of Mars is about: 0
The current bug population of Venus is about: 0
The total bug population of the solar system is: 1480000000000000000
The most useless bug is a mosquito
The most colorful bug is a butterfly
The most colorful bug is a a is bug colorful most The
The current bug adjective is: (null)
Bugs didn't cause me to crash!

$ cat valgrind_output.txt
==#== Memcheck, a memory error detector
==#== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.
==#== Using Valgrind-3.11.0 and LibVEX; rerun with -h for copyright info
==#== Command: ./bugs
==#== 
==#==
==#== HEAP SUMMARY:
==#==     in use at exit: 0 bytes in 0 blocks
==#==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated
==#== 
==#== All heap blocks were freed -- no leaks are possible
==#== 
==#== For counts of detected and suppressed errors, rerun with: -v
==#== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)</pre>

<p class="heading1">Lab Report</p>
<hr width="100%" size="2px" color="red">

<span class="body1">
Once you have fixed the problems in the given program, prepare a report for this
lab answering the following questions. <strong>Please make sure that your lab report is in pdf format</strong>.
</span>

<ol class="body2">
<li> Explain the difference between a hardware breakpoint and a software breakpoint. [5 Points] </li>
<li> Explain the difference between a breakpoint and a watchpoint. [5 Points] </li>
<li> Is it possible to change the value of a varialbe during debug session? If so, mention the gdb command for doing it. [5 Points] </li>
<li> Consider the following piece of code [5 Points]:

<pre><code>#define STRING_LENGTH 256 /* Defined in some obscure header file and included in the source file */

…

int main (void)
{
	char	my_string[STRING_LENGTH] = “This world is a beautiful place!”;
	
	print (“%s\n”, my_string);
	
	return 0;
}</code></pre>

While debugging the program, you place a breakpoint inside the main
function. Once the breakpoint is hit, Your job is to find out the
length of the variable “my_string” (i.e. 256) while debugging. How can
you do that? Remember that the macro will get pre-processed and you
won’t be able to use: 
<br>
<code> print STRING_LENGTH </code></li>
<br>

<li> Consider the following loop [10 Points]:

<pre><code>for (i = 0; i &lt; 1000000; ++i) {
	...
	read_page (i);
	...
}</code></pre>

During the execution of this loop, you get a segmentation fault for
some value of ‘i’ let’s say i = 10000. You want to see what exactly
happens inside the loop in that iteration. One way to do it is to
place a breakpoint in the loop body, manually wait for it to get hit
9999 times and then begin your investigation in the 10000th iteration.
This is certainly undesirable and there should be a better way to do
it. Can you figure out an efficient method to resolve this problem? </li>

<li> Consider the follwing code segment [10 Points]:
<pre><code>void scheduler ( … )
{
	/* Get the priority of the highest priority ready task */
	int priority = get_high_priority ( … );
	
	/* Fetch the actual task */
	TASK* task = fetch_task (priority);
	
	/* Schedule the task */
	run (task);
}</code></pre>

You want to store the priority value when a certain task-x is selected
for running inside the scheduler. Can you figure out a way to do that
using gdb? 
(hint: You may want to use 'conditional breakpoint' and 'convenience
variables' to solve this problem)</li></ol>

<p class="heading1">Submission</p>
<hr width="100%" size="2px" color="red">

<span class="body1"> 
The total grade for this lab will be awarded based on your submitted code [60%]
and lab report [40%]. In order to submit your source code, use the
the 'tar' target included in the lab's Makefile. Change the STUDENT_ID
variable in the Makefile to your student ID and type:
</span>
<pre class="coding1">make tar</pre>
<br>
<br>
<br>
<br>


<p title="Using Debuggers"><a href="http://www.ittc.ku.edu/%7Eheechul/courses/eecs678/S17/labs/index.html">&lt; Back to the Lab Home Page</a></p>




</body></html>